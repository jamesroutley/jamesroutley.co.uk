---
layout: default
title: Status
---

<h1>Status</h1>

<dl>
  <dt>
    Server status:
  </dt>
  <dd id="server-state">...</dd>
  <dt>
    Public IP:
  </dt>
  <dd id="public-ip">...</dd>
</dl>

<button type="button" onclick="startInstance()">Start Instance</button>
<button type="button" onclick="stopInstance()">Stop Instance</button>

<p id="start-stop-notification"></p>

<script>
  function loadInstanceState() {
    fetch('https://dyl0f3yzfg.execute-api.eu-west-1.amazonaws.com/prod/')
      .then(function(response) {
        return response.json()
      })
      .then(function(json) {
        var ip;
        document.getElementById("server-state").innerHTML = json.State;
        if (json.PublicIp === null) {
          ip = "n/a";
        }
        else {
          ip = json.PublicIp;
        }
        document.getElementById("public-ip").innerHTML = ip;
      }).catch(function(ex) {
        console.log('parsing failed', ex)
      })
  }

  function startInstance() {
    fetch(
      'https://dyl0f3yzfg.execute-api.eu-west-1.amazonaws.com/prod/start', {
        method: 'Post',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({})
      }
    )
    .then(function(response) {
      return response.json()
    })
    .then(function(json) {
      console.log(json);
      document.getElementById("start-stop-notification").innerHTML = "Starting instance. This can take several minutes.";
    })
  }

  function stopInstance() {
    fetch(
      'https://dyl0f3yzfg.execute-api.eu-west-1.amazonaws.com/prod/stop', {
        method: 'Post',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({})
      }
    )
    .then(function(response) {
      return response.json()
    })
    .then(function(json) {
      console.log(json);
      document.getElementById("start-stop-notification").innerHTML = "Stopping instance. This can take several minutes.";
    })
  }

  window.onload = loadInstanceState
</script>
